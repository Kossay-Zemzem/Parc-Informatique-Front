<div class="flex flex-col h-full min-h-[500px] p-4">
    <h2 class="text-xl font-bold mb-3 text-[#024a97]">
        Historique
    </h2>

    <div class="mb-4 flex flex-col gap-2 overflow-y-auto" style="max-height: 300px;">
        <div class="flex flex-row w-full font-semibold border-b pb-2">
            <span class="w-1/3">Date</span>
            <span class="w-2/3">Description</span>
        </div>
        <div *ngFor="let entry of history; let i = index" class="flex items-center border-b py-2">
            <div class="flex flex-row w-full">
                <span class="font-medium w-1/3">{{ entry.date | date:'shortDate' }}</span>
                <span class="w-2/3 break-words whitespace-pre-line overflow-hidden text-ellipsis"
                    style="word-break: break-word; display: block;">{{ entry.description }}</span>
            </div>
            <button *ngIf="!data.viewOnly" (click)="deleteEntry(entry.id)"
                class="ml-2 mr-4 text-red-500 hover:text-red-700">
                <lucide-icon name="trash-2" size="20"></lucide-icon>
            </button>
        </div>
    </div>
    <div class="flex flex-col gap-2">
        <ng-container *ngIf="!data.viewOnly">
            <div class="font-semibold mb-2">Ajouter une entrée à l'historique</div>
            <div class="flex flex-row gap-2 mb-4">
                <input type="date" class="border rounded-lg p-2 w-1/3" [(ngModel)]="newDate" />
                <input type="text" placeholder="Description" class="border rounded-lg p-2 w-2/3"
                    [(ngModel)]="newDescription" />
            </div>
            <div class="flex justify-end gap-2">
                <button class="px-3 py-1.5 rounded-lg bg-gray-200 hover:bg-gray-300" (click)="onClose()">Cancel</button>
                <button class="px-3 py-1.5 rounded-lg bg-[#024a97] text-white hover:bg-[#002752]"
                    (click)="addEntry()">Save</button>
            </div>
        </ng-container>
        <ng-container *ngIf="data.viewOnly">
            <div class="flex justify-end gap-2">
                <button class="px-3 py-1.5 rounded-lg bg-[#c71509] text-white hover:bg-[#a31207]"
                    (click)="onClose()">Fermer</button>
            </div>
        </ng-container>
    </div>
</div>